<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>MSC Team Members</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:20px; }
    h1 { text-align:center; }
    #grid { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; }
    .card { background:white; width:250px; border-radius:12px; padding:15px; text-align:center; box-shadow:0 5px 15px rgba(0,0,0,0.1);}
    img { width:120px; height:120px; border-radius:50%; object-fit:cover; margin-bottom:10px; }
    .name { font-weight:bold; font-size:16px; margin:5px 0; }
    .role { color:#0073e6; font-size:14px; margin-bottom:5px; }
    .bio, .skills { font-size:13px; color:#333; margin-bottom:5px; }
  </style>
</head>
<body>
  <h1>MSC Team Members</h1>
  <div id="grid">Loading...</div>

<script>
(async function(){
  const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRlMlgwKNONgeuXGBm0gR8jVbaJnz60vQRQr0YcPTg8pF8HVBz0kN6wN8Q2WOS10tE7gHOQsWjIubp/pubhtml/gviz/tq?tqx=out:json";

  try{
    const res = await fetch(sheetUrl);
    const txt = await res.text();
    const json = JSON.parse(txt.substr(47).slice(0,-2));
    const rows = json.table.rows.slice(1); // skip header

    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    rows.forEach(r => {
      const name = r.c[2]?.v || "";
      const dept = r.c[3]?.v || "";
      const role = r.c[4]?.v || "";
      const bio = r.c[5]?.v || "";
      const skills = r.c[6]?.v || "";
      let photo = r.c[7]?.v || "";

      // convert Google Drive URL to direct view
      if(photo){
        const match = photo.match(/\/d\/([a-zA-Z0-9_-]+)\//);
        if(match) photo = `https://drive.google.com/uc?export=view&id=${match[1]}`;
      } else {
        photo = "https://via.placeholder.com/120?text=No+Image";
      }

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img src="${photo}" alt="${name}">
        <div class="name">${name}</div>
        <div class="role">${role} - ${dept}</div>
        <div class="bio">${bio}</div>
        <div class="skills"><b>Skills:</b> ${skills}</div>
      `;
      grid.appendChild(card);
    });

  }catch(err){
    document.getElementById("grid").innerHTML = "Failed to load team data.";
    console.error(err);
  }
})();
</script>
</body>
</html>
